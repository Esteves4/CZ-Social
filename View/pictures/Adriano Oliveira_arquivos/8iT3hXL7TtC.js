if (self.CavalryLogger) { CavalryLogger.start_js(["SSWgk"]); }

__d('GraphQLQuery',['createObjectFrom'],function a(b,c,d,e,f,g){var h,i;if(c.__markCompiled)c.__markCompiled();j.prototype.addField=function(l){'use strict';if(this.fieldSet){this.fieldSet.fields.push(l);}else this.fieldSet=new k.FieldSet([l]);};j.prototype.addFields=function(l){'use strict';l.forEach(this.addField,this);};function j(){'use strict';}h=babelHelpers.inherits(k,j);i=h&&h.prototype;function k(l,m){'use strict';i.constructor.call(this);this.rootCall=l;this.fieldSet=m;}k.prototype.toString=function(){'use strict';return (this.rootCall||'')+(this.fieldSet||'');};k.Call=function(){function l(m,n){'use strict';this.name=m;this.args=n||[];}l.prototype.toString=function(){'use strict';return this.name+'('+this.args.join(',')+')';};return l;}();k.CallValue=function(){function l(m){'use strict';this.callValue=m;}l.prototype.toString=function(){'use strict';return this.callValue.replace(/[)(}{><,.\\]/g,'\\$&');};return l;}();k.CallVariable=function(){function l(m){'use strict';this.callVariableName=m;}l.prototype.toString=function(){'use strict';return '<'+this.callVariableName+'>';};return l;}();k.Field=function(){var l,m;l=babelHelpers.inherits(n,j);m=l&&l.prototype;function n(o,p,q,r,s,t){'use strict';this.name=r||o;this.fieldName=o;this.calls=p||[];this.fieldSet=q;this.alias=r;this.condition=s;this.exports=t||[];}n.prototype.toString=function(){'use strict';var o='';if(this.condition)o+=this.condition+'?';o+=this.fieldName;if(this.calls.length!==0)o+='.'+this.calls.join('.');if(this.alias)o+=' as '+this.alias;if(this.exports.length!==0){o+=' exports ';o+=this.exports.length===1?this.exports[0]:'('+this.exports.join(',')+')';}if(this.fieldSet)o+=this.fieldSet;return o;};n.prototype.addCall=function(o){'use strict';this.calls.push(o);};n.prototype.removeCalls=function(o){'use strict';var p=c('createObjectFrom')(o),q=[];for(var r=0;r<this.calls.length;r++)if(!p[this.calls[r].name])q.push(this.calls[r]);this.calls=q;};return n;}();k.FieldSet=function(){function l(m){'use strict';this.fields=m||[];}l.prototype.getFields=function(){'use strict';var m=[];for(var n=0;n<this.fields.length;n++)if(this.fields[n] instanceof k.Field)m.push(this.fields[n]);return m;};l.prototype.getFragmentReferences=function(){'use strict';var m=[];for(var n=0;n<this.fields.length;n++)if(this.fields[n] instanceof k.FragmentReference)m.push(this.fields[n]);return m;};l.prototype.toString=function(){'use strict';return '{'+this.fields.join(',')+'}';};return l;}();k.FragmentReference=function(){function l(m,n,o){'use strict';this.name=m;this.is_conditional=n;this.exports=o||[];}l.prototype.toString=function(){'use strict';var m='@'+this.name;if(this.is_conditional)m='?'+m;if(this.exports.length!==0){m+=' exports ';m+=this.exports.length===1?this.exports[0]:'('+this.exports.join(',')+')';}return m;};return l;}();f.exports=k;},null);
__d('GraphQLParser',['GraphQLQuery'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(l){'use strict';this.queryString=l;this.queryLength=l.length;this.index=-1;this.character=null;this.next();}h.prototype.error=function(l){'use strict';throw new h.SyntaxError(this.queryString,this.index,l);};h.prototype.next=function(l){'use strict';if(l&&l!==this.character)this.error('Expected "'+l+'" instead of "'+this.character+'".');this.index++;if(this.index>this.queryLength){this.error('Expected another character, but at end of string.');}else this.character=this.index===this.queryLength?null:this.queryString[this.index];};h.prototype.end=function(){'use strict';if(this.character)this.error('Expected end of string instead of '+this.character+'.');};h.prototype.whitespace=function(){'use strict';while(this.character===' '||this.character==='\t'||this.character==='\r'||this.character==='\n')this.next();};h.prototype.mandatoryWhitespace=function(){'use strict';var l=this.index;this.whitespace();if(this.index===l)this.error('Expected whitespace, got '+this.character+'.');};h.prototype.keyword=function(l){'use strict';for(var m=0;m<l.length;m++)this.next(l[m]);};h.prototype.query=function(l){'use strict';var m=null;if(l){m=new (c('GraphQLQuery').Call)(this.name(),this.callArguments());this.whitespace();}var n=null;if(this.character==='{')n=this.fieldSet();return new (c('GraphQLQuery'))(m,n);};h.prototype.name=function(){'use strict';var l=this.index;if(this.character===':')this.error('Name cannot begin with :');while(j(this.character))this.next();if(this.index===l)this.error('Expected name.');return this.queryString.substr(l,this.index-l);};h.prototype.fieldSet=function(){'use strict';var l=[];this.next('{');this.whitespace();l.push(this.field());this.whitespace();while(this.character===','){this.next(',');this.whitespace();l.push(this.field());this.whitespace();}this.next('}');return new (c('GraphQLQuery').FieldSet)(l);};h.prototype.exports=function(){'use strict';var l;if(this.character==='('){this.next('(');while(true){this.whitespace();l=l||[];l.push(this.name());if(this.character===','){this.next(',');}else break;}this.whitespace();this.next(')');}else l=[this.name()];return l;};h.prototype.field=function(){'use strict';var l;if(this.character==='@'||this.character==='?'){var m=false;if(this.character==='?'){this.next('?');m=true;}this.next('@');var n=this.name();this.whitespace();if(this.character==='e'){this.keyword('exports');this.mandatoryWhitespace();l=this.exports();}return new (c('GraphQLQuery').FragmentReference)(n,m,l);}var o,p,q=this.name();this.whitespace();if(this.character==='?'){this.next('?');this.whitespace();o=this.name();p=q;}else o=q;this.whitespace();var r=this.calls(),s;if(this.character==='a'){this.next('a');this.next('s');this.whitespace();s=this.name();this.whitespace();}if(this.character==='e'){this.keyword('exports');this.mandatoryWhitespace();l=[this.name()];this.whitespace();}this.whitespace();var t;if(this.character==='{')t=this.fieldSet();return new (c('GraphQLQuery').Field)(o,r,t,s,p,l);};h.prototype.calls=function(){'use strict';var l=[];while(this.character==='.'){this.next('.');this.whitespace();l.push(new (c('GraphQLQuery').Call)(this.name(),this.callArguments()));this.whitespace();}return l;};h.prototype.callArguments=function(){'use strict';this.next('(');this.whitespace();var l=[];if(this.character!==')'){l.push(this.callArgument());while(this.character===','){this.next(',');this.whitespace();l.push(this.callArgument());}}this.next(')');return l;};h.prototype.callArgument=function(){'use strict';return this.character==='<'?this.callVariable():this.callValue();};h.prototype.callVariable=function(){'use strict';this.next('<');var l=this.name();this.next('>');return new (c('GraphQLQuery').CallVariable)(l);};h.prototype.callValue=function(){'use strict';var l=this.index,m=false;while(k(this.character)){if(this.character==='\\'){this.next();m=true;}this.next();}if(this.index===l)this.error('Expected call value.');var n=this.index-l,o=this.queryString.substr(l,n);o=o.replace(/\s+$/,'');if(m)for(var p=0;p<n;++p)if(o[p]==='\\'){o=o.substr(0,p)+o.substr(p+1);--n;}return new (c('GraphQLQuery').CallValue)(o);};h.SyntaxError=function(){var l,m;l=babelHelpers.inherits(n,Error);m=l&&l.prototype;function n(o,p,q){'use strict';this.queryString=o;this.character=p;this.parserError=q;this.message='Syntax error "'+q+'" '+'at character '+p+' '+'near "'+i(o,p)+'" '+'in query: '+o;}return n;}();function i(l,m){return (l.substr(0,m+1).replace(/\s+/g,' ').substr(-10)+'\u20DD'+l.substr(m+1).replace(/\s+/g,' ').substr(0,10));}function j(l){if(l===null)return false;return l==='_'||l===':'||l==='-'||l>='0'&&l<='9'||l>='A'&&l<='Z'||l>='a'&&l<='z';}function k(l){if(l===null)return false;return l!='('&&l!=')'&&l!='{'&&l!='}'&&l!='<'&&l!='>'&&l!='.'&&l!=',';}h.parseQuery=function(l){var m=new h(l);m.whitespace();var n=m.query(true);m.whitespace();m.end();return n;};h.parseRootlessQuery=function(l){var m=new h(l);m.whitespace();var n=m.query(false);m.whitespace();m.end();return n;};f.exports=h;},null);
__d("PagedQuery",["GraphQLParser","GraphQLQuery","keyOf","isEmpty"],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i,j){"use strict";this.$PagedQuery1=i;this.$PagedQuery2=j;}h.prototype.$PagedQuery3=function(){"use strict";var i=this.findFieldByPath(this.$PagedQuery1);i.removeCalls(['find','after','before','first','last']);return i;};h.prototype.$PagedQuery4=function(i,j,k){"use strict";var l=this.$PagedQuery3(),m=k?'after':'before';l.addCall(new (c("GraphQLQuery").Call)(m,[i]));var n=k?'first':'last';l.addCall(new (c("GraphQLQuery").Call)(n,[j]));return this.$PagedQuery1.toString();};h.prototype.$PagedQuery5=function(i){"use strict";var j=this.$PagedQuery2[i];if(typeof j=='object'&&!c("isEmpty")(j))return c("keyOf")(j);return null;};h.prototype.$PagedQuery6=function(i){"use strict";var j=this.$PagedQuery5(i);if(j)return j;return this.$PagedQuery2[i];};h.prototype.$PagedQuery7=function(i){"use strict";var j=this.$PagedQuery5(i);if(j)return this.$PagedQuery2[i][j];return this.$PagedQuery2[i];};h.prototype.pageAfterQueryString=function(i,j){"use strict";return this.$PagedQuery4(i,j,true);};h.prototype.pageBeforeQueryString=function(i,j){"use strict";return this.$PagedQuery4(i,j,false);};h.prototype.pageFirstQueryString=function(i){"use strict";var j=this.$PagedQuery3();j.addCall(new (c("GraphQLQuery").Call)('first',[i]));return this.$PagedQuery1.toString();};h.prototype.pageLastQueryString=function(i){"use strict";var j=this.$PagedQuery3();j.addCall(new (c("GraphQLQuery").Call)('last',[i]));return this.$PagedQuery1.toString();};h.prototype.findFieldByPath=function(i){"use strict";var j=i,k=this.$PagedQuery6(0);if(i.rootCall.name!=k)throw new Error("Query path does not match root query at top node, "+"expected "+k+", "+"found "+i.name+" instead.");for(var l=1;l<this.$PagedQuery2.length;l++){var m=j.fieldSet.fields,n=false,o=this.$PagedQuery6(l);for(var p=0;p<m.length;p++)if(m[p].fieldName==o){j=m[p];n=true;break;}if(!n)throw new Error("Query path does not match query structure at location "+l+", "+"expected "+o+", "+"not located in "+m);}return j;};h.prototype.findDataByPath=function(i){"use strict";var j=i;for(var k=0;k<this.$PagedQuery2.length;k++){var l=this.$PagedQuery7(k);if(!j||!j[l])throw new Error("Query path does not match payload at location "+k+", "+"expected "+l);j=j[l];}return j;};h.constructFromPath=function(i,j){return new h(c("GraphQLParser").parseQuery(i),j);};f.exports=h;},null);
__d("PagedQueryCache",["KeyedCallbackManager","GraphQLParser","emptyFunction"],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i,j,k,l){"use strict";i=i.bind(this);this.$PagedQueryCache1=this.$PagedQueryCache1.bind(this,i),this.$PagedQueryCache2=j;this.$PagedQueryCache3=babelHelpers["extends"]({enableLooping:false},l);var m=this.$PagedQueryCache2.findDataByPath(k),n=m.edges;this.$PagedQueryCache4=m.page_info;this.$PagedQueryCache5=new (c("KeyedCallbackManager"))();this.$PagedQueryCache6={};this.$PagedQueryCache7={};this.$PagedQueryCache8={};this.$PagedQueryCache9=0;this.$PagedQueryCache10=0;this.$PagedQueryCache11={};this.$PagedQueryCache12(n,0);if(this.$PagedQueryCache3.allDataLoaded)this.$PagedQueryCache13();}h.prototype.$PagedQueryCache1=function(i,j,k,l,m,n,o){"use strict";var p=c("GraphQLParser").parseQuery(j),q=k.findFieldByPath(p),r={};for(var s=0;s<q.calls.length;s++){var t=q.calls[s];if(t.args.length>0)r[t.name]=t.args[0].callValue;}Object.assign(r,n);i(j,k,l,m,r,o);};h.prototype.$PagedQueryCache12=function(i,j){"use strict";var k={},l=false;for(var m=0;m<i.length;m++){if(this.hasLooped())break;var n=j+m,o=i[m].cursor,p=i[m].node,q=this.$PagedQueryCache6[o];if(this.$PagedQueryCache3.enableLooping&&q!==undefined){l=true;continue;}var r=this.$PagedQueryCache5.getResource(n);if(r!==undefined&&r!=o)throw new Error('Attempting to add cursor '+o+' at location '+n+' which already contains cursor '+r);this.$PagedQueryCache8[p.id]=o;this.$PagedQueryCache7[o]=p;k[n]=o;this.$PagedQueryCache6[o]=n;this.$PagedQueryCache9=Math.min(n,this.$PagedQueryCache9);this.$PagedQueryCache10=Math.max(n,this.$PagedQueryCache10);}if(l)this.$PagedQueryCache13();this.$PagedQueryCache5.addResourcesAndExecute(k);};h.prototype.getItemsAfterCursor=function(i,j,k){"use strict";this.$PagedQueryCache14(i,j,true,k);};h.prototype.getItemsBeforeCursor=function(i,j,k){"use strict";this.$PagedQueryCache14(i,j,false,k);};h.prototype.$PagedQueryCache15=function(i){"use strict";if(!this.hasLooped())return i;var j=this.$PagedQueryCache16.end-this.$PagedQueryCache16.start+1;while(i<this.$PagedQueryCache16.start||i>this.$PagedQueryCache16.end)if(i<this.$PagedQueryCache16.start){i+=j;}else i-=j;return i;};h.prototype.$PagedQueryCache14=function(i,j,k,l){"use strict";var m=this.$PagedQueryCache17(i);if(!k)m=m-j-1;var n=[];for(var o=1;o<=j;o++)n.push(this.$PagedQueryCache15(m+o));var p=this.$PagedQueryCache5.getUnavailableResourcesFromRequest(n);if(p.length){p=this.$PagedQueryCache18(p);if(!p.length)return;var q;if(k){if(this.$PagedQueryCache3.enableLooping&&!this.hasNextPage(i)){q=this.$PagedQueryCache2.pageFirstQueryString(j);}else q=this.$PagedQueryCache2.pageAfterQueryString(i,j);}else if(this.$PagedQueryCache3.enableLooping&&!this.hasPreviousPage(i)){q=this.$PagedQueryCache2.pageLastQueryString(j);}else q=this.$PagedQueryCache2.pageBeforeQueryString(i,j);for(var r=0;r<p.length;++r)this.$PagedQueryCache11[p[r]]=true;this.$PagedQueryCache19&&this.$PagedQueryCache19();this.$PagedQueryCache1(q,this.$PagedQueryCache2,p,k?this.$PagedQueryCache3.first_query:this.$PagedQueryCache3.last_query,this.$PagedQueryCache3.persistent_params,this.$PagedQueryCache20.bind(this));}var s=function(t){var u=[];for(var v=0;v<j;v++)u.push(this.$PagedQueryCache7[t[n[v]]]);return u;}.bind(this);this.$PagedQueryCache5.executeOrEnqueue(n,function(t){l(s(t));});};h.prototype.$PagedQueryCache20=function(){"use strict";this.$PagedQueryCache21.apply(this,arguments);};h.prototype.$PagedQueryCache17=function(i){"use strict";var j=this.$PagedQueryCache6[i];if(j===undefined)throw new Error("Cursor not found: the request can still be made but the result "+"would not link to the existing data");return j;};h.prototype.setPayloadCallback=function(i){"use strict";this.$PagedQueryCache21=i;};h.prototype.updateData=function(i){"use strict";var j=this.$PagedQueryCache2.findDataByPath(i.query_results),k=j&&j.edges;if(!k)return;for(var l=0;l<k.length;++l){var m=k[l].cursor,n=k[l].node;if(this.$PagedQueryCache7[m]===undefined)this.$PagedQueryCache7[m]={};for(var o in n)this.$PagedQueryCache7[m][o]=n[o];}};h.prototype.addData=function(i){"use strict";var j=false,k=null,l=0;for(var m in i.query_params){if(m=='after'||m=='before')k=i.query_params[m];if(m=='first'||m=='last'){j=m=='first';l=i.query_params[m];}}if(this.$PagedQueryCache3.enableLooping&&!k)k=j?this.$PagedQueryCache4.end_cursor:this.$PagedQueryCache4.start_cursor;if(!k||this.$PagedQueryCache6[k]===undefined)return;var n=this.$PagedQueryCache6[k],o=this.$PagedQueryCache2.findDataByPath(i.query_results);if(!o.edges.length){this.$PagedQueryCache22(i.requested_indices);if(j){this.$PagedQueryCache4.has_next_page=false;this.$PagedQueryCache3.enableLooping&&this.getItemsAfterCursor(k,l,c("emptyFunction"));}else{this.$PagedQueryCache4.has_previous_page=false;this.$PagedQueryCache3.enableLooping&&this.getItemsBeforeCursor(k,l,c("emptyFunction"));}return;}var p;if(j){p=n+1;this.$PagedQueryCache4.end_cursor=o.page_info.end_cursor;this.$PagedQueryCache4.has_next_page=o.page_info.has_next_page;}else{p=n-o.edges.length;this.$PagedQueryCache4.start_cursor=o.page_info.start_cursor;this.$PagedQueryCache4.has_previous_page=o.page_info.has_previous_page;}this.$PagedQueryCache12(o.edges,p);this.$PagedQueryCache22(i.requested_indices);};h.prototype.hasNextPage=function(i){"use strict";var j=this.$PagedQueryCache17(i);if(this.$PagedQueryCache5.getResource(j+1)){return true;}else if(i==this.$PagedQueryCache4.end_cursor){return this.$PagedQueryCache4.has_next_page;}else throw new Error('hasNextPage called on unknown cursor');};h.prototype.hasPreviousPage=function(i){"use strict";var j=this.$PagedQueryCache17(i);if(this.$PagedQueryCache5.getResource(j-1)){return true;}else if(i==this.$PagedQueryCache4.start_cursor){return this.$PagedQueryCache4.has_previous_page;}else throw new Error('hasPreviousPage called on unknown cursor');};h.prototype.hasLooped=function(){"use strict";return this.$PagedQueryCache3.enableLooping&&this.$PagedQueryCache16;};h.prototype.getItemAtIndex=function(i,j){"use strict";i=this.$PagedQueryCache15(i);this.$PagedQueryCache5.executeOrEnqueue([i],function(k){j(this.$PagedQueryCache7[k[i]]);}.bind(this));};h.prototype.getItemAtIndexImmediate=function(i){"use strict";i=this.$PagedQueryCache15(i);var j=this.$PagedQueryCache5.getResource(i),k;if(j)k=this.$PagedQueryCache7[j];return k;};h.prototype.getAvailableRange=function(){"use strict";var i=this.$PagedQueryCache17(this.$PagedQueryCache4.start_cursor),j=this.$PagedQueryCache17(this.$PagedQueryCache4.end_cursor);return {offset:i,length:j-i+1};};h.prototype.getCursorForID=function(i){"use strict";return this.$PagedQueryCache8[i];};h.prototype.getIndexForID=function(i){"use strict";var j=this.getCursorForID(i);return j!==undefined?this.$PagedQueryCache6[j]:undefined;};h.prototype.$PagedQueryCache22=function(i){"use strict";if(i)for(var j=0;j<i.length;++j)delete this.$PagedQueryCache11[i[j]];};h.prototype.$PagedQueryCache18=function(i){"use strict";if(!this.$PagedQueryCache11)return i;var j=[];for(var k=0;k<i.length;++k)if(!this.$PagedQueryCache11[i[k]])j.push(i[k]);return j;};h.prototype.$PagedQueryCache13=function(){"use strict";this.$PagedQueryCache16={start:this.$PagedQueryCache9,end:this.$PagedQueryCache10};};h.prototype.setPreFetchCallback=function(i){"use strict";this.$PagedQueryCache19=i;};f.exports=h;},null);
__d('PhotoStorePagedQueryCacheCore',['PagedQuery','PagedQueryCache'],function a(b,c,d,e,f,g){var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('PagedQueryCache'));i=h&&h.prototype;function j(k,l){'use strict';var m=k.query_results,n=k.query_metadata,o=c('PagedQuery').constructFromPath(n.query_string,n.query_path);i.constructor.call(this,l,o,m,babelHelpers['extends']({enableLooping:true},n.config));this.$PhotoStorePagedQueryCacheCore1=k.set_id;this.$PhotoStorePagedQueryCacheCore2=k.payloadsource;this.setPayloadCallback(this.$PhotoStorePagedQueryCacheCore3.bind(this));}j.prototype.$PhotoStorePagedQueryCacheCore3=function(k){'use strict';k.set_id=this.$PhotoStorePagedQueryCacheCore1;this.broadcastUpdate(this.$PhotoStorePagedQueryCacheCore2,k);};j.prototype.broadcastUpdate=function(k,l){'use strict';};f.exports=j;},null);
__d('sendPagedQueryRequestDefault',['AsyncRequest'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i,j,k,l,m,n){new (c('AsyncRequest'))('/ajax/graphql/query/').setData({queryName:l,params:m}).setHandler(function(o){var p=o.getPayload();n({requested_indices:k,query_results:JSON.parse(p.output),query_metadata:{query_string:p.query},query_params:m});}).setAllowCrossPageTransition(true).send();}f.exports=h;},null);
__d('BadgedButton',['cx','Button.react','React','joinClasses'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('React').createClass({displayName:'BadgedButton',render:function(){var j=this.props.count>1?this.props.pluralLabel:this.props.singularLabel,k=null;if(this.props.count>0)k=c('React').createElement('div',{className:"_4_-d"+(this.props.bounce?' '+"_3yk":'')},this.props.count);return (c('React').createElement('div',babelHelpers['extends']({},this.props,{className:c('joinClasses')(this.props.className,"_4_-e")}),c('React').createElement(c('Button.react'),{label:j,use:'confirm',size:'large',className:"_4_-f"}),k));}});f.exports=i;},null);
__d('PhotoCentralUpdates',['Arbiter'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={handleUpdate:function(i,j){var k=babelHelpers['extends']({payloadsource:i},j);c('Arbiter').inform('update-photos',k);},handlePhotoSets:function(i,j){var k=babelHelpers['extends']({payloadsource:i},j);c('Arbiter').inform('update-photosets',k);}};f.exports=h;},null);
__d('PhotoStorePagedQueryCache',['PhotoCentralUpdates','PhotoStorePagedQueryCacheCore','sendPagedQueryRequestDefault'],function a(b,c,d,e,f,g){var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('PhotoStorePagedQueryCacheCore'));i=h&&h.prototype;function j(k,l){'use strict';i.constructor.call(this,k,l||c('sendPagedQueryRequestDefault'));}j.prototype.broadcastUpdate=function(k,l){'use strict';c('PhotoCentralUpdates').handleUpdate(k,l);};f.exports=j;},null);
__d('PhotocropConstraintConstants',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={BOUNDARY:'boundary',SQUARE:'square',WIDE:'wide'};h.getAspectRatioForType=function(i){switch(i){case h.SQUARE:return 1;case h.WIDE:return 16/9;default:return null;}};f.exports=h;},null);
__d('PhotocropConstraint',['Vector','PhotocropConstraintConstants','clamp'],function a(b,c,d,e,f,g){var h,i,j,k;if(c.__markCompiled)c.__markCompiled();function l(p){'use strict';this.photocrop=p;this.pos=null;}l.prototype.onMouseMove=function(p,q,r){'use strict';var s=p.sub(this.pos);if(q){this.onResize(s,r);}else this.onMove(s);this.pos=this.pos.add(s);};l.prototype.onMouseDown=function(p){'use strict';this.pos=p;};l.prototype.onResize=function(p,q){'use strict';};l.prototype.onMove=function(p){'use strict';var q=this.photocrop.box,r=this.photocrop.wrapper.offsetWidth,s=this.photocrop.wrapper.offsetHeight;p.x=c('clamp')(p.x,-q.l,r-q.r);p.y=c('clamp')(p.y,-q.t,s-q.b);this.photocrop.box=q.add(p);};h=babelHelpers.inherits(m,l);i=h&&h.prototype;m.prototype.onResize=function(p,q){'use strict';var r=this.photocrop.min_width,s=this.photocrop.min_height,t=this.photocrop.box,u=this.photocrop.wrapper.offsetWidth,v=this.photocrop.wrapper.offsetHeight;switch(q){case 'ne':t.r+=p.x=c('clamp')(p.x,t.l+r-t.r,u-t.r);t.t+=p.y=c('clamp')(p.y,-t.t,t.b-s-t.t);break;case 'nw':t.l+=p.x=c('clamp')(p.x,-t.l,t.r-r-t.l);t.t+=p.y=c('clamp')(p.y,-t.t,t.b-s-t.t);break;case 'se':t.r+=p.x=c('clamp')(p.x,t.l+r-t.r,u-t.r);t.b+=p.y=c('clamp')(p.y,t.t+s-t.b,v-t.b);break;case 'sw':t.l+=p.x=c('clamp')(p.x,-t.l,t.r-r-t.l);t.b+=p.y=c('clamp')(p.y,t.t+s-t.b,v-t.b);break;}};function m(){'use strict';h.apply(this,arguments);}j=babelHelpers.inherits(n,l);k=j&&j.prototype;n.prototype.setRatio=function(p){'use strict';this.ratio=p;return this;};n.prototype.onMouseDown=function(p){'use strict';k.onMouseDown.call(this,p);var q=this.photocrop.box,r=q.r-q.l,s=q.b-q.t;this.displacement=new (c('Vector'))(r,s);};n.prototype.$AspectRatioConstraint1=function(p,q,r,s,t,u){'use strict';var v,w,x,y,z;v=this.displacement.x/this.displacement.y;w=y=c('clamp')(q,p,r);x=z=c('clamp')(t,s,u);if(v>this.ratio){x=c('clamp')(w/this.ratio,s,u);w=x*this.ratio;}else{w=c('clamp')(x*this.ratio,p,r);x=w/this.ratio;}return new (c('Vector'))(w,x);};n.prototype.onResize=function(p,q){'use strict';var r=this.photocrop.min_width,s=this.photocrop.min_height,t=this.photocrop.box,u=this.photocrop.wrapper.offsetWidth,v=this.photocrop.wrapper.offsetHeight,w;switch(q){case 'ne':this.displacement=this.displacement.add(p.x,-p.y);w=this.$AspectRatioConstraint1(r,this.displacement.x,u-t.l,s,this.displacement.y,t.b);t.r=t.l+w.x;t.t=t.b-w.y;break;case 'nw':this.displacement=this.displacement.add(-p.x,-p.y);w=this.$AspectRatioConstraint1(r,this.displacement.x,t.r,s,this.displacement.y,t.b);t.l=t.r-w.x;t.t=t.b-w.y;break;case 'se':this.displacement=this.displacement.add(p.x,p.y);w=this.$AspectRatioConstraint1(r,this.displacement.x,u-t.l,s,this.displacement.y,v-t.t);t.r=t.l+w.x;t.b=t.t+w.y;break;case 'sw':this.displacement=this.displacement.add(-p.x,p.y);w=this.$AspectRatioConstraint1(r,this.displacement.x,t.r,s,this.displacement.y,v-t.t);t.l=t.r-w.x;t.b=t.t+w.y;break;}};function n(){'use strict';j.apply(this,arguments);}function o(p,q){var r;switch(q){case c('PhotocropConstraintConstants').BOUNDARY:r=new m(p);break;case c('PhotocropConstraintConstants').WIDE:case c('PhotocropConstraintConstants').SQUARE:r=new n(p).setRatio(c('PhotocropConstraintConstants').getAspectRatioForType(q));break;default:throw Error('unsupported PhotocropConstraint type');}return r;}f.exports=o;},null);
__d('Photocrop2',['ArbiterMixin','PhotocropConstraintConstants','CSS','DOM','Event','PhotosConst','Rect','Style','Vector','mixin','PhotocropConstraint'],function a(b,c,d,e,f,g){var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('mixin')(c('ArbiterMixin')));i=h&&h.prototype;function j(k,l,m){'use strict';i.constructor.call(this);this.photo=k;var n=this.getPhotoDimensions();if(m){this.imageDimensions=new (c('Vector'))(m.x,m.y);}else this.imageDimensions=new (c('Vector'))(n.x,n.y);l.height=l.height||c('PhotosConst').PIC_NORMAL_FBX_SIZE;l.width=l.width||c('PhotosConst').PIC_NORMAL_FBX_SIZE;Object.assign(this,{target:this.photo.parentNode,create_target:false,target_parent:this.photo.parentNode,min_width:c('PhotosConst').PIC_NORMAL_FBX_SIZE,min_height:c('PhotosConst').PIC_NORMAL_FBX_SIZE,center_x:(n.x||l.width)/2,center_y:(n.y||l.height)/2,constraint_type:c('PhotocropConstraintConstants').BOUNDARY},l);this._unscaledMinHeight=this.min_height;this._unscaledMinWidth=this.min_width;this._unscaledHeight=this.height;this._unscaledWidth=this.width;this.setInitialDimensionsAndPos();if(this.create_target){this.target=c('DOM').create('div');c('CSS').addClass(this.target,'stageCropper');this.target_parent.appendChild(this.target);}c('CSS').addClass(this.target,'photocrop');['bg','wrapper','viewport'].forEach(function(o){this[o]=c('DOM').create('div');c('CSS').addClass(this[o],o);}.bind(this));this.highlight=c('DOM').create('img');c('CSS').addClass(this.highlight,'highlight');this.setHighlightSource();c('CSS').addClass(this.wrapper,'photocropWrapper');this.target.appendChild(this.bg);this.target.appendChild(this.wrapper);this.wrapper.appendChild(this.highlight);this.wrapper.appendChild(this.viewport);['ne','nw','sw','se'].forEach(function(o){var p=c('DOM').create('div');c('CSS').addClass(p,o);p.setAttribute('data-cropcorner',o);this.viewport.appendChild(p);c('CSS').addClass(p,'profilePicViewportGrabby');}.bind(this));c('Event').listen(this.viewport,{mousedown:this.mousedown.bind(this),dragstart:c('Event').kill,selectstart:c('Event').kill,click:c('Event').stop});c('Event').listen(document,{mousemove:this.mousemove.bind(this),mouseup:this.mouseup.bind(this)});c('Event').listen(window,{resize:this.adjustForResize.bind(this)});this.realignToPictureSize();this.redraw();}j.prototype.setInitialDimensionsAndPos=function(){'use strict';this._constraint=c('PhotocropConstraint')(this,this.constraint_type);var k=c('PhotocropConstraintConstants').getAspectRatioForType(this.constraint_type),l=this.getPhotoDimensions();if(k){this._unscaledMinHeight=this._unscaledMinWidth/k;this._unscaledHeight=this._unscaledWidth/k;}this.setNewRatio();var m=Math.min(this.width,l.x),n=Math.min(this.height,l.y);this.min_width=Math.min(this.min_width,l.x);this.min_height=Math.min(this.min_height,l.y);if(k)if(l.x/l.y>k){n=Math.min(n,l.y);m=n*k;this.min_width=this.min_height*k;}else{m=Math.min(m,l.x);n=m/k;this.min_height=this.min_width/k;}var o=this.center_x-m/2,p=this.center_y-n/2;this.box=new (c('Rect'))(p,o+m,p+n,o);};j.prototype.getPhotoDimensions=function(){'use strict';return new (c('Vector'))(Math.round(parseFloat(c('Style').get(this.photo,'width'))),Math.round(parseFloat(c('Style').get(this.photo,'height'))));};j.prototype.getPhotoPosition=function(){'use strict';return new (c('Vector'))(this.photo.offsetLeft,this.photo.offsetTop);};j.prototype.setHighlightSource=function(){'use strict';this.highlight.src=this.photo.src;};j.prototype.setConstraintType=function(k){'use strict';this.constraint_type=k;this.setInitialDimensionsAndPos();this.adjustForResize();};j.prototype.adjustForResize=function(){'use strict';var k=this.ratio,l=this.setNewRatio(),m=l/k;this.box.t*=m;this.box.l*=m;this.box.b*=m;this.box.r*=m;this.redraw();this.realignToPictureSize();};j.prototype.setNewRatio=function(){'use strict';this.ratio=this.getPhotoDimensions().x/this.imageDimensions.x;this.min_width=this.ratio*this._unscaledMinWidth;this.min_height=this.ratio*this._unscaledMinHeight;this.width=Math.max(1,this.ratio)*this._unscaledWidth;this.height=Math.max(1,this.ratio)*this._unscaledHeight;return this.ratio;};j.prototype.realignToPictureSize=function(){'use strict';var k=this.photo;if(!k)return;var l=this.getPhotoDimensions(),m=this.getPhotoPosition();[this.bg,this.wrapper].forEach(function(n){n.style.width=l.x+'px';n.style.height=l.y+'px';n.style.top=m.y+'px';n.style.left=m.x+'px';});};j.prototype.redraw=function(){'use strict';var k=[this.box.t,this.box.r,this.box.b,this.box.l],l=this.getPhotoDimensions();this.highlight.style.width=l.x+"px";this.highlight.style.height=l.y+"px";this.highlight.style.clip="rect("+k.join("px ")+"px)";this.viewport.style.top=this.box.t+"px";this.viewport.style.left=this.box.l+"px";this.viewport.style.height=this.box.b-this.box.t+"px";this.viewport.style.width=this.box.r-this.box.l+"px";};j.prototype.done=function(k){'use strict';this.freezeViewport=true;if(!k){[this.bg,this.wrapper].forEach(c('DOM').remove);if(this.create_target){c('DOM').remove(this.target);this.target=null;}else c('CSS').removeClass(this.target,'photocrop');}var l=Math.round(this.box.l*(1/this.ratio)),m=Math.round(this.box.t*(1/this.ratio)),n=Math.round(this.box.r*(1/this.ratio)),o=Math.round(this.box.b*(1/this.ratio));this.inform('done',k);return {x:Math.max(l,0),y:Math.max(m,0),width:n-Math.max(l,0),height:o-Math.max(m,0)};};j.prototype.reset=function(){'use strict';this.freezeViewport=false;};j.prototype.mousedown=function(k){'use strict';if(this.freezeViewport)return;this.mouseTarget=k.getTarget();this._constraint.onMouseDown(c('Vector').getEventPosition(k));c('CSS').addClass(document.body,'draggingMode');return false;};j.prototype.mousemove=function(k){'use strict';if(!this.mouseTarget)return;this._constraint.onMouseMove(c('Vector').getEventPosition(k),this.mouseTarget!==this.viewport,this.mouseTarget.getAttribute('data-cropcorner'));this.redraw();return false;};j.prototype.mouseup=function(k){'use strict';this.mouseTarget=null;c('CSS').removeClass(document.body,'draggingMode');};f.exports=j;},null);
__d('ProfilePicRequestCreator',['URI','XProfilePicSaver','tidyEvent'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i,j){'use strict';this.saver=new (c('XProfilePicSaver'))(String(i),String(j));c('tidyEvent')([this.saver.subscribe('success',this.$ProfilePicRequestCreator1.bind(this)),this.saver.subscribe('error',this.$ProfilePicRequestCreator2.bind(this))]);this.setSuccessURI(new (c('URI'))('/profile.php').setQueryData({id:j}));this.setErrorURI(new (c('URI'))('/photo.php').setQueryData({pid:i,profile_id:j}));}h.prototype.setSuccessURI=function(i){'use strict';this.$ProfilePicRequestCreator3=i;return this;};h.prototype.setErrorURI=function(i){'use strict';this.$ProfilePicRequestCreator4=i;return this;};h.prototype.setProfilePhotoSource=function(i){'use strict';i&&this.saver.setProfilePhotoSource(i);return this;};h.prototype.setProfilePhotoMethod=function(i){'use strict';i&&this.saver.setProfilePhotoMethod(i);return this;};h.prototype.setFlowType=function(i){'use strict';this.saver.setFlowType(i);return this;};h.prototype.savePic=function(){'use strict';this.saver.saveAsProfilePic();};h.prototype.saveCrop=function(i,j){'use strict';this.saver.saveCroppedProfilePic({x:i.x/j.x,y:i.y/j.y,width:i.width/j.x,height:i.height/j.y});};h.prototype.$ProfilePicRequestCreator1=function(){'use strict';this.$ProfilePicRequestCreator3.go(true);};h.prototype.$ProfilePicRequestCreator2=function(){'use strict';this.$ProfilePicRequestCreator4.go(true);};f.exports=h;},null);
__d('SpotlightViewerBottomBar',['cx','LeftRight.react','React','joinClasses'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('React').createClass({displayName:'SpotlightViewerBottomBar',render:function(){var j=Array.isArray(this.props.children)?this.props.children:[this.props.children],k="_4_8n _51an";if(this.props.className)k=c('joinClasses')(k,this.props.className);if(j.length===1)return (c('React').createElement('div',{className:k},j[0]));k=c('joinClasses')(k,"_50-m");return (c('React').createElement(c('LeftRight.react'),{className:k},j[0],j[1]));}});f.exports=i;},null);
__d('SpotlightViewerBottomBarGroup',['cx','React'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('React').createClass({displayName:'SpotlightViewerBottomBarGroup',render:function(){var j=this.props.itemmargin||'right',k=(j=='left'?"marginLeft":'')+(j=='right'?' '+"marginRight":'')+(' '+"_4_8i");return (c('React').createElement('div',{className:k},this.props.children));}});f.exports=i;},null);
__d('SpotlightViewerBottomBarLink',['cx','Link.react','React'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('React').createClass({displayName:'SpotlightViewerBottomBarLink',render:function(){return (c('React').createElement(c('Link.react'),babelHelpers['extends']({},this.props,{className:"_4_8j _4_8k"}),this.props.children));}});f.exports=i;},null);
__d('SpotlightViewerCheck',['cx','Link.react','React'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('React').createClass({displayName:'SpotlightViewerCheck',getInitialState:function(){return {selected:this.props.selected};},render:function(){var j=(this.props.selected?"_4_d3":'')+(' '+"_4_d2")+(' '+"_51an")+(' '+"_4bi")+(this.props.bounce?' '+"_3yk":'');return c('React').createElement(c('Link.react'),{className:j,onClick:this.props.onClick});}});f.exports=i;},null);
__d('SpotlightViewerCroppingBar',['cx','fbt','React','SpotlightViewerBottomBar','SpotlightViewerBottomBarGroup','SpotlightViewerBottomBarLink'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=c('React').createClass({displayName:'SpotlightViewerCroppingBar',_getBarGroupContents:function(){if(this.props.saving)return (c('React').createElement('span',{className:"_4_8j"},i._("Salvando sua nova foto do perfil")));return [c('React').createElement(c('SpotlightViewerBottomBarLink'),{onClick:this.props.onDone},i._("Recorte finalizado")),c('React').createElement(c('SpotlightViewerBottomBarLink'),{onClick:this.props.onCancel},i._("Cancelar"))];},render:function(){return (c('React').createElement(c('SpotlightViewerBottomBar'),null,c('React').createElement(c('SpotlightViewerBottomBarGroup'),null,this._getBarGroupContents())));}});f.exports=j;},null);
__d('SpotlightViewerOptionsMenu',['fbt','ContextualLayerAutoFlip','React','ReactMenu','PopoverMenu.react','SpotlightViewerBottomBarLink'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('ReactMenu').Item,j=c('React').createClass({displayName:'SpotlightViewerOptionsMenu',_onItemClick:function(k,l){this.props.callback&&this.props.callback(l.item.getValue());},render:function(){var k=c('React').createElement(c('ReactMenu'),{onItemClick:this._onItemClick},this.props.items.map(function(l){return (c('React').createElement(i,{value:l.value,title:l.label,href:l.href||'#'},l.label));}));return (c('React').createElement(c('PopoverMenu.react'),{menu:k,layerBehaviors:[c('ContextualLayerAutoFlip')],onShow:this.props.onShow,onHide:this.props.onHide},c('React').createElement(c('SpotlightViewerBottomBarLink'),null,h._("Op\u00e7\u00f5es"))));}});f.exports=j;},null);
__d('SpotlightViewerUpdateUrlOnNav',['PageTransitions','PhotoUtils','URI','VaultBoxURI','goURI'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i){'use strict';this._viewer=i;this._registered=false;this._shouldUpdateURL=false;this._suppressNextEvent=false;}h.prototype.enable=function(){'use strict';this._registered=false;this._subscriptions=[this._viewer.subscribe('open',this._onOpen.bind(this)),this._viewer.subscribe('close',this._onClose.bind(this)),this._viewer.subscribe('photo_change',this._onPhotoChange.bind(this))];this._enabled=true;};h.prototype.disable=function(){'use strict';for(var i=0;i<this._subscriptions.length;i++)this._subscriptions[i].unsubscribe();this._subscriptions=[];this._enabled=false;};h.prototype._registerTransition=function(){'use strict';if(this._registered)return;c('PageTransitions').registerHandler(this._handleTransition.bind(this));this._registered=true;};h.prototype._handleTransition=function(i){'use strict';if(!this._enabled)return false;if(this._shouldUpdateURL){this._shouldUpdateURL=false;c('PageTransitions').transitionComplete();return true;}this._suppressNextEvent=true;if(this._viewer.openURL(i)){c('PageTransitions').transitionComplete();return true;}if(this._viewer.isOpen()&&c('VaultBoxURI').isVaultArchiveURI(i)){this._suppressNextEvent=true;this._viewer.close();c('PageTransitions').transitionComplete();return true;}this._suppressNextEvent=false;return false;};h.prototype._onOpen=function(){'use strict';this._registerTransition();this._openURI=c('URI').getMostRecentURI().getUnqualifiedURI();};h.prototype._onClose=function(){'use strict';if(this._suppressNextEvent){this._suppressNextEvent=false;return;}var i=this._viewer.removePermalinkQueryData(this._openURI);this._updateURL(i);};h.prototype._onPhotoChange=function(i,j){'use strict';if(this._suppressNextEvent){this._suppressNextEvent=false;return;}this._updateURL(c('PhotoUtils').getPermalinkFromData(j));};h.prototype._updateURL=function(i){'use strict';this._shouldUpdateURL=true;c('goURI')(i);};f.exports=h;},null);
__d('SpotlightVaultViewer',['cx','fbt','Arbiter','ArbiterMixin','AsyncDialog','AsyncRequest','BadgedButton','CSSAnimations','LoadingIndicator.react','Parent','Photocrop2','PhotosConst','PhotoStore','PhotosUploadWaterfall','PhotoUtils','ProfilePicRequestCreator','ProfilePictureFlowLogging','React','ReactDOM','SpotlightViewer','SpotlightViewerAutoResize','SpotlightViewerBehaviorsMixin','SpotlightViewerBottomBar','SpotlightViewerBottomBarGroup','SpotlightViewerBottomBarLink','SpotlightViewerCheck','SpotlightViewerClose','SpotlightViewerCoreMixin','SpotlightViewerCroppingBar','SpotlightViewerDimensionMixin','SpotlightViewerOptionsMenu','SpotlightViewerPagers','SpotlightViewerPageWithKeys','SpotlightViewerUpdateUrlOnNav','SpotlightViewport','SubscriptionsHandler','URI','VaultBoxURI','VaultPageGrid','Vector'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=c('React').createClass({displayName:'SpotlightVaultViewer',mixins:[c('ArbiterMixin'),c('SpotlightViewerBehaviorsMixin'),c('SpotlightViewerCoreMixin'),c('SpotlightViewerDimensionMixin')],behaviors:[c('SpotlightViewerUpdateUrlOnNav'),c('SpotlightViewerPageWithKeys'),c('SpotlightViewerAutoResize')],getViewerID:function(){return 'vaultbox';},optionsMenuValues:{DOWNLOAD:0,CROP:1,ROTATE_LEFT:2,ROTATE_RIGHT:3,MAKE_COVER_PHOTO:4},getInitialState:function(){this._grid=c('VaultPageGrid').getInstance(this.props.gridid);this._subscriptions=new (c('SubscriptionsHandler'))();return {photoData:this._getInitialPhotoData(),open:true,selectionSet:this._grid.getSelectionSet(),croppingMode:false,savingMode:false,menuOpen:false,bounce:false};},_getInitialPhotoData:function(){var k=c('PhotoStore').getIndexForID(this.props.setid,this.props.photoid),l=c('PhotoStore').getByIndexImmediate(this.props.setid,k);return l?l:this._getThumbnailPhotoData();},_getThumbnailPhotoData:function(){if(!this.props.normaldimensions||!this.props.thumbsrc)return null;var k=c('Vector').deserialize(this.props.normaldimensions),l={id:this.props.photoid,image1:{width:k.x,height:k.y,uri:this.props.thumbsrc}};if(this.props.hiresdimensions){var m=c('Vector').deserialize(this.props.hiresdimensions);l.image2={width:m.x,height:m.y,uri:this.props.thumbsrc};}return l;},_enableSubscriptions:function(){this._subscriptions.addSubscriptions(c('Arbiter').subscribe('VaultSharerDialog/imagesShared',this.close),c('Arbiter').subscribe('SpotlightVaultViewer/imageDeleted',this._onDelete),this.viewState.subscribe('photo_fetch',this.setState.bind(this,{photoData:null},null)));},removePermalinkQueryData:function(k){if(c('VaultBoxURI').isVaultBoxURI(k))return new (c('URI'))(k).removeQueryData('view_image');return k;},_onShareClick:function(event){if(this.state.selectionSet.getLength()===0){this.state.selectionSet.add(this._getCurrentFBID());this.setState({selectionSet:this.state.selectionSet});}this._grid.createPost(event.target);},_onSelect:function(){var k=this._getCurrentFBID();if(!this.state.selectionSet.contains(k)){this.state.selectionSet.add(k);}else this.state.selectionSet.remove(k);this.setState({selectionSet:this.state.selectionSet,bounce:true});setTimeout(this.setState.bind(this,{bounce:false}),c('CSSAnimations').getBounceTimeout());},_onClickOptions:function(k){if(k==this.optionsMenuValues.CROP){this._enableCropping();}else if(k==this.optionsMenuValues.ROTATE_LEFT){this._rotate('left');}else if(k==this.optionsMenuValues.ROTATE_RIGHT){this._rotate('right');}else if(k==this.optionsMenuValues.MAKE_COVER_PHOTO)this.close();},_rotate:function(k){var l=this._getCurrentFBID(),m={fbid:l,cs_ver:c('PhotosConst').VIEWER_VAULTBOX};m[k]=1;var n=this.viewState.getPosition();new (c('AsyncRequest'))('/ajax/photos/photo/rotate/').setAllowCrossPageTransition(true).setData(m).setFinallyHandler(this.rotationComplete.bind(this,n)).setErrorHandler(this.rotationComplete.bind(this,n)).setMethod('POST').setReadOnly(false).send();this.viewState.inform('photo_fetch');},rotationComplete:function(k){if(k==this.viewState.getPosition())c('PhotoStore').getByIndex(this.props.setid,k,this._updatePhoto);},_enableCropping:function(){c('ProfilePictureFlowLogging').setAction(c('ProfilePictureFlowLogging').action.MAKE_PROFILE).setFlowType(c('ProfilePictureFlowLogging').flow.VAULT).log(c('ProfilePictureFlowLogging').step.CROP);var k=this.getDimensions().getOriginalDimensionsFromPhoto(this.state.photoData);this._photocrop=new (c('Photocrop2'))(c('ReactDOM').findDOMNode(this.refs.image),{},k);this.setState({croppingMode:true});},_disableCropping:function(){c('ProfilePictureFlowLogging').setFlowType(c('ProfilePictureFlowLogging').flow.VAULT).log(c('ProfilePictureFlowLogging').step.CANCEL);this._photocrop&&this._photocrop.done(false);this.setState({croppingMode:false});},componentDidMount:function(){if(this.props.enablecropping)this._enableCropping();},_crop:function(){var k=this._getCurrentFBID(),l=this.state.photoData.owner.id,m=this._photocrop.done(),n=this.getDimensions().getOriginalDimensionsFromPhoto(this.state.photoData);new (c('ProfilePicRequestCreator'))(k,l).setErrorURI(c('URI').getRequestURI()).setFlowType(c('ProfilePictureFlowLogging').flow.VAULT).saveCrop(m,n);this.setState({croppingMode:false,savingMode:true});},_isCroppingEnabled:function(){return this.state.croppingMode||this.state.savingMode;},_delete:function(event){var k=new (c('AsyncRequest'))('/ajax/vault/delete.php').setData({vault_image_ids:[this._getCurrentFBID()],source:c('PhotosUploadWaterfall').SPOTLIGHT_VAULT_VIEWER}).setStatusElement(c('Parent').byClass(event.target,'stat_elem')).setRelativeTo(event.target);c('AsyncDialog').send(k);},_onDelete:function(){this.close();c('PhotoStore').clearSetCache(this.props.setid);},openURL:function(k){var l=k.getQueryData('view_image').view_image;if(!l)return false;this.viewState.page(this.viewState.getRelativeMovement(l));return true;},_getBottomBar:function(){if(!this.state.photoData)return null;if(this._isCroppingEnabled())return (c('React').createElement(c('SpotlightViewerCroppingBar'),{onDone:this._crop,onCancel:this._disableCropping,saving:this.state.savingMode}));return (c('React').createElement(c('SpotlightViewerBottomBar'),{className:'stat_elem'},c('React').createElement(c('SpotlightViewerBottomBarGroup'),null,c('React').createElement(c('SpotlightViewerBottomBarLink'),{onClick:this._delete},i._("Excluir")),this._getOptionsMenu(),c('React').createElement('div',{className:"_4_8j"},c('React').createElement(c('LoadingIndicator.react'),{size:c('LoadingIndicator.react').SIZES.small,color:c('LoadingIndicator.react').COLORS.blue,showonasync:true,className:"_535k"}))),c('React').createElement(c('SpotlightViewerBottomBarGroup'),{itemmargin:'left'},c('React').createElement(c('BadgedButton'),{onClick:this._onShareClick,className:"_4_8j",count:this.state.selectionSet.getLength(),singularLabel:i._("Compartilhar foto"),pluralLabel:i._("Compartilhar fotos"),bounce:this.state.bounce}))));},_getCheck:function(){if(!this.state.photoData||this._isCroppingEnabled())return null;var k=this.state.selectionSet.contains(this._getCurrentFBID());return (c('React').createElement(c('SpotlightViewerCheck'),{bounce:this.state.bounce,selected:k,onClick:this._onSelect}));},_getPagers:function(){if(this._isCroppingEnabled())return null;return c('React').createElement(c('SpotlightViewerPagers'),null);},_getOptionsMenu:function(){if(!this.state.photoData)return null;var k=[],l=c('PhotoUtils').getDownloadURLFromData(this.state.photoData);if(l)k.push({label:i._("Baixar"),value:this.optionsMenuValues.DOWNLOAD,href:c('PhotoUtils').getDownloadURLFromData(this.state.photoData)});if(this.state.photoData.owner)k.push({label:i._("Usar como foto do perfil"),value:this.optionsMenuValues.CROP});if(c('PhotoUtils').canViewerMakeCoverPhoto(this.state.photoData))k.push({label:i._("Usar como foto da capa"),value:this.optionsMenuValues.MAKE_COVER_PHOTO,href:c('PhotoUtils').getCoverPhotoURLFromData(this.state.photoData)});k.push({label:i._("Girar para a esquerda"),value:this.optionsMenuValues.ROTATE_LEFT});k.push({label:i._("Girar para a direita"),value:this.optionsMenuValues.ROTATE_RIGHT});return (c('React').createElement(c('SpotlightViewerOptionsMenu'),{items:k,callback:this._onClickOptions,onShow:this.setState.bind(this,{menuOpen:true},null),onHide:this.setState.bind(this,{menuOpen:false},null)}));},render:function(){var k=this.getMedia(),l=this.getStageDimensions();return (c('React').createElement(c('SpotlightViewer'),{open:this.state.open,onHide:this.close},c('React').createElement(c('SpotlightViewport'),{active:this.state.menuOpen,onClick:this._onClickViewport,stageDimensions:l,media:k,showLoadingIndicator:!this.state.photoData},c('React').createElement(c('SpotlightViewerClose'),{onClick:this.close,position:'left'}),this._getCheck(),this._getBottomBar(),this._getPagers())));}});f.exports=j;},null);
__d('VaultBoxInit',['AsyncRequest','DOM','PhotoStore','React','SpotlightVaultViewer','SpotlightViewerInit','VaultPageGrid'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={setID:'vault:images_by_date_taken',bootstrapWithElem:function(i){c('SpotlightViewerInit').render(c('React').createElement(c('SpotlightVaultViewer'),{open:true,gridid:i.getAttribute('data-grid-id'),setid:h.setID,photoid:i.getAttribute('data-fbid'),thumbsrc:c('DOM').find(i,'img').src,hiresdimensions:i.getAttribute('data-hi-res-dimensions'),normaldimensions:i.getAttribute('data-normal-dimensions')}));if(!c('PhotoStore').hasBeenCreated(h.setID))new (c('AsyncRequest'))('/ajax/photos/vaultbox/init_react.php').setRelativeTo(i).setData({photoID:i.getAttribute('data-fbid')}).send();},bootstrapFromPermalink:function(i,j,k,l){c('VaultPageGrid').getInstanceWithCallback(k,function(){c('SpotlightViewerInit').render(c('React').createElement(c('SpotlightVaultViewer'),{open:true,setid:h.setID,initialpayload:i,photoid:j,gridid:k,enablecropping:l.enableCropping}));});}};f.exports=h;},null);