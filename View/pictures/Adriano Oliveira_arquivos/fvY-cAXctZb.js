/*!CK:1313511697!*//*1461073249,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["iFp+z"]); }

__d('ScopedSearchItemView.react',['cx','React'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('React').createClass({displayName:'ScopedSearchItemView',_onSelectAttempt:function(){this.props.onSelectAttempt(this.props.entry);},render:function(){var j="_1jh9"+(this.props.highlighted?' '+"_1jha":'')+(this.props.entry.isSeeMore?' '+"_5wtr":'')+(' '+"_599m");return (c('React').createElement('li',{className:j,onMouseDown:this._onSelectAttempt},c('React').createElement('span',{className:"_5wts",rel:'ignore'},c('React').createElement('a',{href:this.props.entry.getURI()},c('React').createElement('span',{className:"_5wtt"},c('React').createElement('span',{className:"_5wtu"})),c('React').createElement('span',{className:"_5wtv"},this.props.entry.getTitle())))));}});f.exports=i;},null);
__d('ScopedSearchListView.react',['cx','React','ScopedSearchItemView.react'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('React').createClass({displayName:'ScopedSearchListView',render:function(){var j="_5mrx"+(' '+"_599r")+(!this.props.entries.length?' '+"_599s":'');return (c('React').createElement('div',{className:j},this.props.entries.map(function(k){return (c('React').createElement(c('ScopedSearchItemView.react'),{entry:k,key:k.getUniqueID(),highlighted:k==this.props.highlightedEntry,onSelectAttempt:this.props.onSelectAttempt,queryString:this.props.queryString}));}.bind(this))));}});f.exports=i;},null);
__d('ScopedSearchableEntry',['SearchableEntry'],function a(b,c,d,e,f,g){var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('SearchableEntry'));i=h&&h.prototype;function j(k){'use strict';i.constructor.call(this,k);this.isSeeMore=k.isSeeMore;this.uri=k.uri;}j.prototype.setPosition=function(k){'use strict';this.$ScopedSearchableEntry1=k;return this;};j.prototype.getPosition=function(){'use strict';return this.$ScopedSearchableEntry1;};f.exports=j;},null);
__d('WebAsyncSearchSourceWithMetrics',['AbstractAsyncSearchSource','AbstractSearchSource','AsyncRequest','Map','TypeaheadMetricReporter','WebAsyncSearchSourceUtils','uuid'],function a(b,c,d,e,f,g){var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('AbstractSearchSource'));i=h&&h.prototype;function j(k,l){'use strict';i.constructor.call(this);this.$WebAsyncSearchSourceWithMetrics1=new (c('AbstractAsyncSearchSource'))(k,this.$WebAsyncSearchSourceWithMetrics4.bind(this),c('WebAsyncSearchSourceUtils').normalizeResponse);this.$WebAsyncSearchSourceWithMetrics2=new (c('TypeaheadMetricReporter'))(l);this.$WebAsyncSearchSourceWithMetrics3=new (c('Map'))();this.$WebAsyncSearchSourceWithMetrics2.addListener&&this.$WebAsyncSearchSourceWithMetrics2.addListener('reset',function(m){this.$WebAsyncSearchSourceWithMetrics1.setRequestData({sid:m.sid});}.bind(this));}j.prototype.bootstrapImpl=function(k){'use strict';this.$WebAsyncSearchSourceWithMetrics2.reportBootstrapBegin();this.$WebAsyncSearchSourceWithMetrics1.bootstrap(function(){this.$WebAsyncSearchSourceWithMetrics1.getBootstrappedEntries(function(l){this.$WebAsyncSearchSourceWithMetrics2.reportBootstrapComplete(l.map(function(m){return m.getType();}));k();}.bind(this));}.bind(this));};j.prototype.searchImpl=function(k,l,m){'use strict';this.$WebAsyncSearchSourceWithMetrics2.reportQueryBegin(k);if(m)this.$WebAsyncSearchSourceWithMetrics2.reportStrategyName(m.strategyName);var n=Date.now();this.$WebAsyncSearchSourceWithMetrics1.search(k,function(o,p,q){this.$WebAsyncSearchSourceWithMetrics2.reportQueryComplete(Date.now()-n,0);l(o,p,q);}.bind(this),m);};j.prototype.getBootstrappedEntries=function(k){'use strict';return this.$WebAsyncSearchSourceWithMetrics1.getBootstrappedEntries(k);};j.prototype.getAllEntriesMap=function(){'use strict';return this.$WebAsyncSearchSourceWithMetrics1.getAllEntriesMap();};j.prototype.getTypeaheadSessionID=function(){'use strict';return this.$WebAsyncSearchSourceWithMetrics2.getSID();};j.prototype.setRequestData=function(k){'use strict';this.$WebAsyncSearchSourceWithMetrics1.setRequestData(k);};j.prototype.sessionStart=function(){'use strict';this.$WebAsyncSearchSourceWithMetrics2.sessionStart();};j.prototype.sessionEnd=function(){'use strict';this.$WebAsyncSearchSourceWithMetrics2.sessionEnd();};j.prototype.reportResults=function(k){'use strict';this.$WebAsyncSearchSourceWithMetrics2.reportResults(k);};j.prototype.reportSelect=function(k,l,m,n,o,p){'use strict';this.$WebAsyncSearchSourceWithMetrics2.reportSelect(k,l,m,n,o,p);};j.prototype.reportRequestID=function(k){'use strict';this.$WebAsyncSearchSourceWithMetrics2.reportRequestID(this.$WebAsyncSearchSourceWithMetrics5(k));};j.prototype.$WebAsyncSearchSourceWithMetrics5=function(k){'use strict';var l=k;while(l.length>0){if(this.$WebAsyncSearchSourceWithMetrics3.has(l))return this.$WebAsyncSearchSourceWithMetrics3.get(l);l=l.slice(0,-1);}return this.$WebAsyncSearchSourceWithMetrics3.get('');};j.prototype.$WebAsyncSearchSourceWithMetrics4=function(k,l,m,n){'use strict';var o=k.value||'',p=c('uuid')();new (c('AsyncRequest'))(l.uri).setData(babelHelpers['extends']({request_id:p},k,l.data)).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true).setInitialHandler(function(){this.$WebAsyncSearchSourceWithMetrics3.set(o,p);}.bind(this)).setHandler(m).setErrorHandler(n).send();};f.exports=j;},null);
__d("XScopedSearchTypeaheadController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/async\/search\/scoped\/typeahead\/",{value:{type:"String"},entity_id:{type:"Int"},entity_type:{type:"Enum",enumType:1},sid:{type:"String"},max_results:{type:"Int"}});},null);
__d('ScopedSearchTypeahead.react',['ix','cx','fbt','DOMQuery','FacebarStructuredText','Focus','Image.react','React','ReactDOM','ScopedSearchListView.react','ScopedSearchableEntry','URI','WebAsyncSearchSourceWithMetrics','XScopedSearchTypeaheadController','XUITypeahead.react','fbglyph'],function a(b,c,d,e,f,g,h,i,j){'use strict';if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes,l=c('React').createClass({displayName:'ScopedSearchTypeahead',propTypes:{entityID:k.number.isRequired,entityType:k.string.isRequired,baseSearchURI:k.string.isRequired,loggerEventName:k.string.isRequired,placeholder:k.string.isRequired,stubSearchBox:k.object.isRequired},getInitialState:function(){var m={uri:c('XScopedSearchTypeaheadController').getURIBuilder().getURI(),data:{entity_id:this.props.entityID,entity_type:this.props.entityType}},n={bootstrapRequests:[m],queryRequests:[m],getAllForEmptyQuery:true,packageFn:this._createSearchableEntry},o={event_name:this.props.loggerEventName,log:this._logCandidates},p=new (c('WebAsyncSearchSourceWithMetrics'))(n,o);p.sessionStart();return {matchingEntries:[],queryString:'',searchSource:p};},componentWillMount:function(){this.setState({queryString:c('DOMQuery').find(this.props.stubSearchBox,'input').value});},componentDidMount:function(){if(this.state.queryString){var m=c('ReactDOM').findDOMNode(this).querySelector('input[type="text"]');c('Focus').set(m);m.selectionStart=m.selectionEnd=m.value.length;}},componentWillUnmount:function(){this.state.searchSource.sessionEnd();},_logCandidates:function(){return JSON.stringify(this.state.matchingEntries.map(function(m){return m.getUniqueID();}));},_createSearchableEntry:function(m){return new (c('ScopedSearchableEntry'))({uniqueID:m.uid,title:m.text,type:m.type,fragments:m.fragments,queryString:this.state.queryString,uri:m.uri});},_onSelectAttempt:function(m){new (c('URI'))(m.uri).go();this.state.searchSource.reportSelect(m.getUniqueID(),m.getType(),m.getPosition(),true,this.state.queryString,null);},_onEnterWithoutSelection:function(){new (c('URI'))(this.props.baseSearchURI).addQueryData('query',this.state.queryString).go();this.state.searchSource.reportSelect(this.state.queryString,'keyword',-1,false,this.state.queryString,null);},_onEntriesFound:function(m){if(this.state.queryString){var n=this.state.queryString.trim(),o=j._("Ver todos os resultados para \"{query}\"",[j.param('query',n)]),p=new (c('URI'))(this.props.baseSearchURI).addQueryData({query:n}).toString();m.push(new (c('ScopedSearchableEntry'))({uniqueID:o,title:o,queryString:this.state.queryString,structure:c('FacebarStructuredText').fromString(o),isSeeMore:true,uri:p}));}m.map(function(q,r){return q.setPosition(r);});this.setState({matchingEntries:m});},_onTypeaheadBlur:function(){this.state.searchSource.sessionEnd();},_onTypeaheadFocus:function(){this.state.searchSource.sessionStart();},_onChange:function(m){this.setState({queryString:m.target.value});},render:function(){var m={ViewRenderer:c('ScopedSearchListView.react'),useLayer:true,extraRendererProps:{alwaysVisibleOnFocus:true,onSelectAttempt:this._onSelectAttempt,queryString:this.state.queryString}};return (c('React').createElement('div',{className:"_3lv7"},c('React').createElement(c('XUITypeahead.react'),{className:"_5mrx",onChange:this._onChange,onBlur:this._onTypeaheadBlur,onFocus:this._onTypeaheadFocus,onEnterWithoutSelection:this._onEnterWithoutSelection,onEntriesFound:this._onEntriesFound,onSelectAttempt:this._onSelectAttempt,placeholder:this.props.placeholder,presenter:m,queryString:this.state.queryString,searchSource:this.state.searchSource,showEntriesOnFocus:true}),c('React').createElement('div',{className:"_3lv8"},c('React').createElement(c('Image.react'),{src:h("\/images\/assets_DO_NOT_HARDCODE\/fb_glyphs\/magnifying-glass_16_bluegray-40.png")}))));}});f.exports=l;},null);